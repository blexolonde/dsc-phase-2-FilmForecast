{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![alt text](../movie-3057394_1280.jpg)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Business Understanding\n",
    "\n",
    "The objective of this project is to analyze historical movie data to generate actionable insights for a new movie studio venture. Specifically, the analysis aims to identify the key factors that contribute to the commercial success of movies, focusing on profitability, audience reception, and production efficiency. This will help the studio make data-driven decisions regarding budget allocation, genre selection, and release strategies to maximize return on investment (ROI) and minimize financial risks.\n",
    "\n",
    "## Key Business Questions:\n",
    "\n",
    "- **Which genres and types of movies yield the highest ROI and profitability?**\n",
    "- **How does production budget correlate with movie revenue and audience ratings?**\n",
    "- **Which studios and production companies have a consistent track record of success?**\n",
    "- **What factors (e.g., runtime, release year, genre) influence a movieâ€™s box office performance?**\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Data Understanding \n",
    "\n",
    "The project involves analyzing multiple datasets collected from various sources to uncover insights, trends, and patterns in the movie industry. Below is a detailed understanding of the datasets, their key features, and the data issues that need to be addressed for a successful analysis:\n",
    "\n",
    "---\n",
    "\n",
    "## 1. **Box Office Mojo Data**\n",
    "\n",
    "**Overview**: This dataset provides box office revenue and studio-related details.\n",
    "\n",
    "- **Shape**: 3,387 rows and 5 columns.\n",
    "\n",
    "### Columns:\n",
    "- **title**: Movie title (non-null).\n",
    "- **studio**: Studio responsible for the movie (5 missing values).\n",
    "- **domestic_gross**: Domestic gross earnings (28 missing values).\n",
    "- **foreign_gross**: Foreign gross earnings (1,350 missing values, stored as strings).\n",
    "- **year**: Release year (non-null).\n",
    "\n",
    "### Key Issues:\n",
    "- `foreign_gross` is stored as strings, requiring conversion to numeric format.\n",
    "- Missing values in the `studio` and revenue columns.\n",
    "\n",
    "---\n",
    "\n",
    "## 2. **The Numbers Data**\n",
    "\n",
    "**Overview**: Focuses on production budgets, domestic, and worldwide gross revenue.\n",
    "\n",
    "- **Shape**: 5,782 rows and 6 columns.\n",
    "\n",
    "### Columns:\n",
    "- **id**: Unique identifier for each movie (non-null).\n",
    "- **release_date**: Movie release date (non-null).\n",
    "- **movie**: Movie title (non-null).\n",
    "- **production_budget**: Production budget (stored as strings with commas, requires conversion).\n",
    "- **domestic_gross** and **worldwide_gross**: Revenue columns stored as strings with commas.\n",
    "\n",
    "### Key Issues:\n",
    "- All revenue columns and budgets are in string format, requiring numeric conversion.\n",
    "- No missing values, but the format needs cleaning for analysis.\n",
    "\n",
    "---\n",
    "\n",
    "## 3. **Rotten Tomatoes Reviews Data**\n",
    "\n",
    "**Overview**: Contains reviews, ratings, and publisher information for movies.\n",
    "\n",
    "- **Shape**: 54,432 rows and 8 columns.\n",
    "\n",
    "### Columns:\n",
    "- **id**: Unique identifier for movies (non-null).\n",
    "- **review**: Textual review (5,563 missing values).\n",
    "- **rating**: Rating given by critics (13,517 missing values).\n",
    "- **fresh**: Whether the review is \"fresh\" or \"rotten\" (non-null).\n",
    "- **critic**: Name of the critic (2,722 missing values).\n",
    "- **top_critic**: Binary flag for top critics (non-null).\n",
    "- **publisher**: Publisher of the review (309 missing values).\n",
    "- **date**: Date of the review (non-null).\n",
    "\n",
    "### Key Issues:\n",
    "- Missing values in `review`, `rating`, and `critic` columns.\n",
    "- Some columns may not directly impact the analysis depending on objectives.\n",
    "\n",
    "---\n",
    "\n",
    "## 4. **Rotten Tomatoes Movie Info Data**\n",
    "\n",
    "**Overview**: Provides additional metadata such as genres, directors, runtime, and box office data.\n",
    "\n",
    "- **Shape**: 1,560 rows and 12 columns.\n",
    "\n",
    "### Columns:\n",
    "- **id**: Unique identifier (non-null).\n",
    "- **synopsis**: Movie synopsis (62 missing values).\n",
    "- **rating**: MPAA rating (3 missing values).\n",
    "- **genre**: Movie genre (8 missing values).\n",
    "- **director**: Director name (199 missing values).\n",
    "- **writer**: Writer name (449 missing values).\n",
    "- **theater_date**: Theater release date (359 missing values).\n",
    "- **dvd_date**: DVD release date (359 missing values).\n",
    "- **currency** and **box_office**: Currency type and box office earnings (non-null values are very sparse).\n",
    "- **runtime**: Runtime of the movie (30 missing values).\n",
    "- **studio**: Studio responsible (sparse).\n",
    "\n",
    "### Key Issues:\n",
    "- High number of missing values in `studio`, `currency`, and `box_office`.\n",
    "- Sparse data may limit the usability of certain columns in the analysis.\n",
    "\n",
    "---\n",
    "\n",
    "## 5. **TheMovieDB Data**\n",
    "\n",
    "![alt text](../movie_data_erd.jpeg)\n",
    "\n",
    "**Overview**: Covers popularity metrics, genre information, vote averages, and counts.\n",
    "\n",
    "- **Shape**: 26,517 rows and 10 columns.\n",
    "\n",
    "### Columns:\n",
    "- **id**: Unique identifier (non-null).\n",
    "- **genre_ids**: List of genre IDs associated with the movie (non-null).\n",
    "- **original_language**: Language of the movie (non-null).\n",
    "- **original_title** and **title**: Original and common titles (non-null).\n",
    "- **popularity**: Popularity score (non-null).\n",
    "- **release_date**: Release date (non-null).\n",
    "- **vote_average** and **vote_count**: Average rating and number of votes (non-null).\n",
    "\n",
    "### Key Issues:\n",
    "- No missing values, but `genre_ids` may require decoding for interpretability.\n",
    "\n",
    "\n",
    "## Dataframes for Analysis\n",
    "\n",
    "Based on the analysis goals, the following datasets will be most useful for deriving insights:\n",
    "\n",
    "### 1. **Box Office Mojo Data**  \n",
    "- **Key Variables**: `title`, `studio`, `domestic_gross`, `foreign_gross`, `year`  \n",
    "- **Usage**: Analyze box office performance, studio performance, and trends in domestic vs. international earnings.\n",
    "\n",
    "### 2. **The Numbers Data**  \n",
    "- **Key Variables**: `movie`, `production_budget`, `domestic_gross`, `worldwide_gross`, `release_date`  \n",
    "- **Usage**: Analyze the correlation between production budgets and box office revenues to assess profitability.\n",
    "\n",
    "### 3. **Rotten Tomatoes Movie Info Data**  \n",
    "- **Key Variables**: `rating`, `genre`, `director`, `runtime`, `box_office`  \n",
    "- **Usage**: Analyze how different factors like genre, director, and runtime impact box office performance.\n",
    "\n",
    "### 4. **TheMovieDB Data**  \n",
    "- **Key Variables**: `title`, `popularity`, `vote_average`, `vote_count`, `release_date`  \n",
    "- **Usage**: Investigate how popularity, audience ratings, and vote counts correlate with box office success.\n",
    "\n",
    "\n",
    "---\n",
    "## Combined Issues and Cleaning Plan\n",
    "\n",
    "### 1. **Data Consistency**\n",
    "- Titles across datasets may differ, which requires careful handling of titles or IDs when merging datasets to ensure consistency.\n",
    "\n",
    "### 2. **Formatting**\n",
    "- Several columns related to revenue and budget (e.g., `domestic_gross`, `worldwide_gross`, `production_budget`, etc.) are stored as strings with special characters (e.g., commas), so these need to be cleaned and converted to numeric values.\n",
    "\n",
    "### 3. **Missing Data**\n",
    "- Sparse columns (e.g., `foreign_gross`, `studio`, `currency`) will need to be addressed using imputation or exclusion depending on their relevance to the analysis.\n",
    "\n",
    "### 4. **Deduplication**\n",
    "- Ensure that there are no duplicate entries after merging datasets. Identifying duplicates based on movie title or ID is crucial for maintaining data quality.\n",
    "\n",
    "### 5. **Alignment**\n",
    "- Date formats, genre categories, and identifiers (like movie IDs) need to be standardized across datasets to ensure consistent analysis.\n",
    "\n",
    "---\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data Cleaning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<>:37: SyntaxWarning: invalid escape sequence '\\$'\n",
      "<>:37: SyntaxWarning: invalid escape sequence '\\$'\n",
      "C:\\Users\\USER\\AppData\\Local\\Temp\\ipykernel_13100\\1486764647.py:37: SyntaxWarning: invalid escape sequence '\\$'\n",
      "  tn_data[column] = tn_data[column].replace('[\\$,]', '', regex=True).astype(float)\n",
      "C:\\Users\\USER\\AppData\\Local\\Temp\\ipykernel_13100\\1486764647.py:37: SyntaxWarning: invalid escape sequence '\\$'\n",
      "  tn_data[column] = tn_data[column].replace('[\\$,]', '', regex=True).astype(float)\n"
     ]
    },
    {
     "ename": "FileNotFoundError",
     "evalue": "[Errno 2] No such file or directory: 'C:\\\\Users\\\\USER\\\\Desktop\\\\ble\\\\zippedData\\\\bom_movie_gross.csv.gz'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mFileNotFoundError\u001b[0m                         Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[2], line 9\u001b[0m\n\u001b[0;32m      6\u001b[0m tn_file_path \u001b[38;5;241m=\u001b[39m \u001b[38;5;124mr\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mC:\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124mUsers\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124mUSER\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124mDesktop\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124mble\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124mzippedData\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124mtn_movie_budgets.csv.gz\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m      8\u001b[0m \u001b[38;5;66;03m# Load datasets\u001b[39;00m\n\u001b[1;32m----> 9\u001b[0m bom_data \u001b[38;5;241m=\u001b[39m \u001b[43mpd\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mread_csv\u001b[49m\u001b[43m(\u001b[49m\u001b[43mbom_file_path\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m     10\u001b[0m tmdb_data \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mread_csv(tmdb_file_path)\n\u001b[0;32m     11\u001b[0m tn_data \u001b[38;5;241m=\u001b[39m pd\u001b[38;5;241m.\u001b[39mread_csv(tn_file_path)\n",
      "File \u001b[1;32mc:\\Users\\USER\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\pandas\\io\\parsers\\readers.py:1026\u001b[0m, in \u001b[0;36mread_csv\u001b[1;34m(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)\u001b[0m\n\u001b[0;32m   1013\u001b[0m kwds_defaults \u001b[38;5;241m=\u001b[39m _refine_defaults_read(\n\u001b[0;32m   1014\u001b[0m     dialect,\n\u001b[0;32m   1015\u001b[0m     delimiter,\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m   1022\u001b[0m     dtype_backend\u001b[38;5;241m=\u001b[39mdtype_backend,\n\u001b[0;32m   1023\u001b[0m )\n\u001b[0;32m   1024\u001b[0m kwds\u001b[38;5;241m.\u001b[39mupdate(kwds_defaults)\n\u001b[1;32m-> 1026\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43m_read\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfilepath_or_buffer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mkwds\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32mc:\\Users\\USER\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\pandas\\io\\parsers\\readers.py:620\u001b[0m, in \u001b[0;36m_read\u001b[1;34m(filepath_or_buffer, kwds)\u001b[0m\n\u001b[0;32m    617\u001b[0m _validate_names(kwds\u001b[38;5;241m.\u001b[39mget(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mnames\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m))\n\u001b[0;32m    619\u001b[0m \u001b[38;5;66;03m# Create the parser.\u001b[39;00m\n\u001b[1;32m--> 620\u001b[0m parser \u001b[38;5;241m=\u001b[39m \u001b[43mTextFileReader\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfilepath_or_buffer\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwds\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    622\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m chunksize \u001b[38;5;129;01mor\u001b[39;00m iterator:\n\u001b[0;32m    623\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m parser\n",
      "File \u001b[1;32mc:\\Users\\USER\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\pandas\\io\\parsers\\readers.py:1620\u001b[0m, in \u001b[0;36mTextFileReader.__init__\u001b[1;34m(self, f, engine, **kwds)\u001b[0m\n\u001b[0;32m   1617\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39moptions[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mhas_index_names\u001b[39m\u001b[38;5;124m\"\u001b[39m] \u001b[38;5;241m=\u001b[39m kwds[\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mhas_index_names\u001b[39m\u001b[38;5;124m\"\u001b[39m]\n\u001b[0;32m   1619\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mhandles: IOHandles \u001b[38;5;241m|\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[1;32m-> 1620\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_engine \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_make_engine\u001b[49m\u001b[43m(\u001b[49m\u001b[43mf\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mengine\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32mc:\\Users\\USER\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\pandas\\io\\parsers\\readers.py:1880\u001b[0m, in \u001b[0;36mTextFileReader._make_engine\u001b[1;34m(self, f, engine)\u001b[0m\n\u001b[0;32m   1878\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mb\u001b[39m\u001b[38;5;124m\"\u001b[39m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;129;01min\u001b[39;00m mode:\n\u001b[0;32m   1879\u001b[0m         mode \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mb\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m-> 1880\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mhandles \u001b[38;5;241m=\u001b[39m \u001b[43mget_handle\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m   1881\u001b[0m \u001b[43m    \u001b[49m\u001b[43mf\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1882\u001b[0m \u001b[43m    \u001b[49m\u001b[43mmode\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1883\u001b[0m \u001b[43m    \u001b[49m\u001b[43mencoding\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43moptions\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mencoding\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1884\u001b[0m \u001b[43m    \u001b[49m\u001b[43mcompression\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43moptions\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mcompression\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1885\u001b[0m \u001b[43m    \u001b[49m\u001b[43mmemory_map\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43moptions\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mmemory_map\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mFalse\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1886\u001b[0m \u001b[43m    \u001b[49m\u001b[43mis_text\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mis_text\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1887\u001b[0m \u001b[43m    \u001b[49m\u001b[43merrors\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43moptions\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mencoding_errors\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mstrict\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1888\u001b[0m \u001b[43m    \u001b[49m\u001b[43mstorage_options\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43moptions\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mget\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mstorage_options\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m   1889\u001b[0m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m   1890\u001b[0m \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mhandles \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m   1891\u001b[0m f \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mhandles\u001b[38;5;241m.\u001b[39mhandle\n",
      "File \u001b[1;32mc:\\Users\\USER\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\site-packages\\pandas\\io\\common.py:765\u001b[0m, in \u001b[0;36mget_handle\u001b[1;34m(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)\u001b[0m\n\u001b[0;32m    761\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m compression \u001b[38;5;241m==\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mgzip\u001b[39m\u001b[38;5;124m\"\u001b[39m:\n\u001b[0;32m    762\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(handle, \u001b[38;5;28mstr\u001b[39m):\n\u001b[0;32m    763\u001b[0m         \u001b[38;5;66;03m# error: Incompatible types in assignment (expression has type\u001b[39;00m\n\u001b[0;32m    764\u001b[0m         \u001b[38;5;66;03m# \"GzipFile\", variable has type \"Union[str, BaseBuffer]\")\u001b[39;00m\n\u001b[1;32m--> 765\u001b[0m         handle \u001b[38;5;241m=\u001b[39m \u001b[43mgzip\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mGzipFile\u001b[49m\u001b[43m(\u001b[49m\u001b[43m  \u001b[49m\u001b[38;5;66;43;03m# type: ignore[assignment]\u001b[39;49;00m\n\u001b[0;32m    766\u001b[0m \u001b[43m            \u001b[49m\u001b[43mfilename\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mhandle\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    767\u001b[0m \u001b[43m            \u001b[49m\u001b[43mmode\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43mioargs\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mmode\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    768\u001b[0m \u001b[43m            \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mcompression_args\u001b[49m\u001b[43m,\u001b[49m\n\u001b[0;32m    769\u001b[0m \u001b[43m        \u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    770\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m    771\u001b[0m         handle \u001b[38;5;241m=\u001b[39m gzip\u001b[38;5;241m.\u001b[39mGzipFile(\n\u001b[0;32m    772\u001b[0m             \u001b[38;5;66;03m# No overload variant of \"GzipFile\" matches argument types\u001b[39;00m\n\u001b[0;32m    773\u001b[0m             \u001b[38;5;66;03m# \"Union[str, BaseBuffer]\", \"str\", \"Dict[str, Any]\"\u001b[39;00m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    776\u001b[0m             \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mcompression_args,\n\u001b[0;32m    777\u001b[0m         )\n",
      "File \u001b[1;32mc:\\Users\\USER\\AppData\\Local\\Programs\\Python\\Python313\\Lib\\gzip.py:194\u001b[0m, in \u001b[0;36mGzipFile.__init__\u001b[1;34m(self, filename, mode, compresslevel, fileobj, mtime)\u001b[0m\n\u001b[0;32m    192\u001b[0m     mode \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mb\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[0;32m    193\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m fileobj \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m--> 194\u001b[0m     fileobj \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mmyfileobj \u001b[38;5;241m=\u001b[39m \u001b[43mbuiltins\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mopen\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfilename\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmode\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;129;43;01mor\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mrb\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[0;32m    195\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m filename \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    196\u001b[0m     filename \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mgetattr\u001b[39m(fileobj, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mname\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "\u001b[1;31mFileNotFoundError\u001b[0m: [Errno 2] No such file or directory: 'C:\\\\Users\\\\USER\\\\Desktop\\\\ble\\\\zippedData\\\\bom_movie_gross.csv.gz'"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "# File paths\n",
    "bom_file_path = r\"C:\\Users\\USER\\Desktop\\ble\\zippedData\\bom_movie_gross.csv.gz\"\n",
    "tmdb_file_path = r\"C:\\Users\\USER\\Desktop\\ble\\zippedData\\tmdb_movies.csv.gz\"\n",
    "tn_file_path = r\"C:\\Users\\USER\\Desktop\\ble\\zippedData\\tn_movie_budgets.csv.gz\"\n",
    "\n",
    "# Load datasets\n",
    "bom_data = pd.read_csv(bom_file_path)\n",
    "tmdb_data = pd.read_csv(tmdb_file_path)\n",
    "tn_data = pd.read_csv(tn_file_path)\n",
    "\n",
    "# ========================\n",
    "# Cleaning `bom_data`\n",
    "# ========================\n",
    "# Replace missing values in 'studio' with 'Unknown'\n",
    "bom_data['studio'].fillna('Unknown', inplace=True)\n",
    "\n",
    "# Convert 'foreign_gross' to numeric\n",
    "bom_data['foreign_gross'] = bom_data['foreign_gross'].replace('[^0-9]', '', regex=True).astype(float)\n",
    "\n",
    "# ========================\n",
    "# Cleaning `tmdb_data`\n",
    "# ========================\n",
    "# Drop unnecessary 'Unnamed: 0' column\n",
    "tmdb_data.drop(columns=['Unnamed: 0'], inplace=True)\n",
    "\n",
    "# Convert 'release_date' to datetime\n",
    "tmdb_data['release_date'] = pd.to_datetime(tmdb_data['release_date'], errors='coerce')\n",
    "\n",
    "# ========================\n",
    "# Cleaning `tn_data`\n",
    "# ========================\n",
    "# Remove formatting from financial columns and convert to numeric\n",
    "financial_columns = ['production_budget', 'domestic_gross', 'worldwide_gross']\n",
    "for column in financial_columns:\n",
    "    tn_data[column] = tn_data[column].replace('[\\$,]', '', regex=True).astype(float)\n",
    "\n",
    "# Convert 'release_date' to datetime\n",
    "tn_data['release_date'] = pd.to_datetime(tn_data['release_date'], errors='coerce')\n",
    "\n",
    "# ========================\n",
    "# Save Cleaned Data\n",
    "# ========================\n",
    "# Saving the cleaned datasets back to the same folder for further use\n",
    "bom_data.to_csv(r\"C:\\Users\\USER\\Desktop\\data_analysis\\cleaned_bom_movie_gross.csv\", index=False)\n",
    "tmdb_data.to_csv(r\"C:\\Users\\USER\\Desktop\\data_analysis\\cleaned_tmdb_movies.csv\", index=False)\n",
    "tn_data.to_csv(r\"C:\\Users\\USER\\Desktop\\data_analysis\\cleaned_tn_movie_budgets.csv\", index=False)\n",
    "\n",
    "print(\"Data cleaning completed and saved!\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
